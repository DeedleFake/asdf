#!/usr/bin/env bash

# Unofficial Bash "strict mode"
# http://redsymbol.net/articles/unofficial-bash-strict-mode/
set -euo pipefail
#ORIGINAL_IFS=$IFS
IFS=$'\t\n' # Stricter IFS settings

# Simpler helper script to extract the current version out of the source in the
# asdf Git repository.

asdf_version() {
  local version git_rev
  root_dir="$(dirname "$(dirname "$(realpath "$0")")")"
  version="$(git --git-dir "${root_dir}/.git" describe --tags --match "v[0-9]*.[0-9]*.[0-9]*" --abbrev=0 2>/dev/null || echo "v0.0.0")"
  git_rev="$(git --git-dir "${root_dir}/.git" rev-parse --short HEAD)"
  printf "%s-%s\n" "$version" "$git_rev"
}

asdf_version
